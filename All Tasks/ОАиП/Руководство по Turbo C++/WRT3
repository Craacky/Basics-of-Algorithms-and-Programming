                           ГЛАВА 3

                    АДМИНИСТРАТОР РЕСУРСОВ

     Администратор ресурсов (Resource Manager) -  это  главное
окно и центр всей активности в Resource Toolkit.  Он обеспечи-
вает доступ к существующим ресурсам и к каждому из  редакторов
ресурсов. Используя Resource Manager, можно:
     - Начать работу любого из Resource Toolkit редакторов.
     - Получить доступ к существующим ресурсам для их редакти-
рования, копирования или удаления.
     - Создать  новый  файл  ресурсов  для  копирования в него
ресурсов.
     - Закрыть  файл  после окончания копирования или удаления
ресурсов.
     Resource Manager  разработан  без меню для быстрой опера-
ции. Чтобы активизировать любую кнопку, можно нажать на кнопку
с помощью мышки или нажать на клавишу клавиатуры, соответствую-
щую подчеркнутой букве кнопки. Например, можно нажать U, чтобы
выбрать Include кнопку.  Можно также нажать клавишу Tab, чтобы
подойти к кнопке или полю,  а затем нажать Enter,  чтобы  "на-
жать" данную кнопку. Resource Manager имеет три главные компо-
ненты: кнопки редактора,  include  кнопка  и  окна  просмотров
ресурсов.
                 Рисунок 3.1 Resource Manager
╔═[■]════════════════════════════════════════════════[°][∙]═╗
║                       Resource Toolkit                    ║
║───────┬────────┬────────┬────────┬──────┬──────┬──────────║
║ Accel │ Bitmap │ Cursor │ Dialog │ Icon │ Menu │ String   ║
║ -     │ -      │ -      │ -      │ -    │ -    │ -        ║
║───────┴────────┴────────┴────────┴──────┴──────┴──────────║
║                        ┌─────────┐                        ║
║┌c:\...\barmenu.res  ─┐ │  Help   │┌─c:\...\menulvls.res ─┐║
║│                     │ └─────────┘│                      │║
║│┌──────────────────┐ │ ┌─────────┐│ ┌─────────────────┐  │║
║││    Close         │ │ │Include  ││ │       Close     │  │║
║│└──────────────────┘ │ └─────────┘│ └─────────────────┘  │║
║│┌──────────────────┐ │ ┌─────────┐│ ┌─────────────────┐  │║
║││Menu              │ │ │<<Copy<< ││ │Menu             │  │║
║│└──────────────────┘ │ └─────────┘│ └─────────────────┘  │║
║│┌──────────────────┐ │ ┌─────────┐│ ┌─────────────────┐  │║
║││A RESOURCE        │ │ │  Edit   ││ │MENULVLS         │  │║
║│├──────────────────┤ │ └─────────┘│ │                 │  │║
║││                  │ │ ┌─────────┐│ │                 │  │║
║││                  │ │ │Rename.. ││ │                 │  │║
║││                  │ │ └─────────┘│ │                 │  │║
║││                  │ │ ┌─────────┐│ │                 │  │║
║││                  │ │ │Delete   ││ │                 │  │║
║││                  │ │ └─────────┘│ └─────────────────┘  │║
║│└──────────────────┘ │            └──────────────────────┘║
║└─────────────────────┘                                    ║
╚══════════════════════════════════════════════════════════─┘

     Кнопки редактирования.  В верхней части экрана  находятся
кнопки для каждого из редакторов. Чтобы начать работу редакто-
ра, нажмите на его кнопку с помощью мышки.
     Окна просмотра  ресурсов.  Resource Manager предоставляет
два окна просмотра ресурсов,  каждое из которых позволяет отк-
рыть некоторые файлы (можно также открыть файлы внутри отдель-
ных редакторов ресурсов).  Так как есть два окна просмотра, то
можно открыть  одновременно  два  файла  и  быстро скопировать
ресурсы из одного файла в другой. Это особенно полезно для ко-
пирования ресурсов в .EXE файл.  Альтернативный способ состоит
в следующем:  можно открыть один файл, затем удалить или отре-
дактировать ресурсы из этого файла. Если Вы выбрали редактиро-
вание ресурса,  Resource Manager автоматически начинает работу
соответствующего редактора и загружает ресурс в этот редактор.
     Include кнопка. Чтобы выбрать тип ресурса, который Вы хо-
тите вывести  на  экран  при открытом файле,  Resource Manager
имеет include кнопку.  Include кнопка открывает диалоговое ок-
но, перечисляющее все типы ресурсов,  которые можно редактиро-
вать или копировать;  можно  выбрать  любую  комбинацию  типов
ресурсов для вывода на экран из открытого файла.

                   Начало работы редактора

     Чтобы начать   работу   одного   из  редакторов  Resource
Toolkit, выберите его кнопку с помощью  мышки.  Альтернативно,
нажмите клавишу клавиатуры, которая соответствует первой букве
в редакторе. Например, нажмите D, чтобы начать работу редакто-
ра диалогового окна. Можно открыть столько редакторов, сколько
позволяет память.  Например, можно открыть редактор пиктограмм
и редактор меню.  Также можно открыть отдельные копии одного и
того же редактора (для работы с  различными  ресурсами);напри-
мер,  можно открыть три версии редактора пиктограмм.
     Примечание. Информация об увеличивающейся доступной памя-
ти содержатся в приложении А.
     Когда редактор открыт, можно создать новый ресурс или от-
редактировать существующий.
     Примечание. Инструкции по использованию каждого редактора
приведены в отдельных главах этого руководства.

                   Создание нового ресурса

     Можно создать  новый  ресурс  тремя  способами. Наиболее
простой способ состоит в том, чтобы начать работу соответству-
ющего редактора,  нажав на его кнопку с помощью мышки. Если Вы
уже находитесь внутри редактора, то выберите File│New .
     Если Вы не находитесь в редакторе, то можно нажать кнопку
New с помощью мышки,  которая находится над одним из  Resource
Manager окон  просмотра  ресурсов.  Используйте этот метод для
создания нового файла так,  чтобы можно было копировать ресурс
из существующего файла.

          Получение доступа к существующим ресурсам

     Можно получить   доступ  к  существующим  ресурсам  двумя
способами: изнутри редактора и из Resource Manager.  Шаги  для
обоих способов  по  существу  одинаковые:  Вы выбираете тип(ы)
ресурсов, который(ые) Вы хотите вывести на экран, затем Вы от-
крываете файл  и выбираете отдельный ресурс для редактирования,
или один или несколько ресурсов для копирования или  удаления.
Эти шаги выполняются в некоторой степени различным образом для
каждого метода.
     Находясь внутри любого редактора, выберите File│Open, вы-
берите тип ресурса, затем выберите файл, откройте его, выбери-
те ресурс и нажмите OK с помощью мышки.
     Из Resource Manager:
     1. Прежде  чем открыть файл,  используйте include кнопку,
чтобы выбрать типы ресурсов,  которые Вы хотите вывести на эк-
ран из открытого файла.
     2. После выбора типов ресурсов, предназначенных для выво-
да на   экран,  используйте  одно  из  Resource  Manager  окон
просмотра, чтобы открыть файл.  Затем выберите один  из  типов
ресурсов. Это  выводит  на  экран отдельные ресурсы выбранного
типа.
     3. Когда  перечисляются отдельные ресурсы,  можно выбрать
один ресурс для редактирования или выбрать один, или несколько
ресурсов для копирования или удаления.
     4. Resource Toolkit автоматически делает резервную  копию
первоначального файла в случае, когда Вы захотите восстановить
ее позже.
     В следующих  разделах подробно обсуждается каждый из этих
шагов и для Resource Manager, и для File│Open .

          Выбор типов ресурсов для вывода на дисплей

     В любое время можно ограничить типы ресурсов, которые бу-
дут вводиться на дисплей для открытого файла.  Например, можно
ограничить вывод на  дисплей  только  ресурсами  пиктограмм  и
курсоров, или только ресурсами меню.
     Чтобы ограничить вывод на экран типы ресурсов:
     1. Из  Resource  Manager  нажмите на Include кнопку с по-
мощью мышки. Это открывает диалоговое окно, которое перечисля-
ет все  типы ресурсов,  которые можно редактировать в Resource
Toolkit. Оно также перечисляет Font, RC данные и типы ресурсов
пользователя, которые  можно копировать,  но нельзя редактиро-
вать.
     2. Проверьте  каждый тип ресурсов,  который Вы хотите вы-
вести на дисплей и не проверяйте типы ресурсов, которые вы хо-
тите исключить из вывода на дисплей.
     - Нажмите с помощью мышки на каждое пустое окно проверки,
которое Вы хотите проверить.
     - Нажмите с помощью мышки на проверенное окно,  чтобы  не
проверять его.
     Include Resource Type диалоговое окно обеспечивает  быст-
рый способ включения или выключения всех типов ресурсов.  Если
ни одно из окон не проверяется,  или некоторые из них проверя-
ются, нажмите с помощью мышки на кнопку Select All, чтобы выб-
рать все типы ресурсов. Если проверяются все ресурсы, то кноп-
ка изменяется на UnSelect All кнопку,  которая очищает все вы-
боры при ее нажатии.  Из File│Open диалогового окна  редактора
установите File Type зависимую кнопку.

                 Открытие существующего файла

Чтобы открыть     существующий     файл(или     из    Resource
Manager или из редактора), вначале выберите типы ресурсов, ко-
торые Вы  хотите  вывести  на  экран  при открытом файле,  как
это описано в предыдущем разделе. Затем:
     1. В  Resource  Manager определите,  какое окно просмотра
ресурса Вы хотите использовать и нажмите с помощью  мышки  его
Open кнопку.  Это открывает File Open диалоговое окно. Если Вы
открываете файл в редакторе, Вы уже находитесь в File Open ди-
алоговом окне.
     Имеющиеся файлы перечислены в левом окне списка File Open
диалогового  окна,  а  текущий  справочник  указан  выше  окна
списка.  Правое  окно списка показывает имеющиеся справочники.
Замечание:  Выше окна списка диалоговое  окно  указывает  типы
файлов,  которые  будут выведены на экран в левом окне списка.
Эти типы файлов не влияют на типы ресурсов, которые Вы выбира-
ете  на  первом шаге.  Include кнопка влияет на вывод на экран
типов ресурсов из открытого файла.  Она не влияет на вывод  на
экран типов файлов из справочника. Также, когда файл открыт из
редактора,  Вы не в состоянии сделать выбор среди  всех  типов
ресурсов, хранимых в файле.
     2. Если файл не находится в текущем справочнике, измените
текущий справочник на справочник, где находится этот файл.
     3. Два  раза  нажмите  на  нужный файл или выберите его и
нажмите на OK кнопку диалогового окна.  В Resource Manager это
выводит на  экран  тип  ресурса  в  поле  редактирования  окна
просмотра и выбирает первый ресурс этого типа  в  окне  списка
окна просмотра.  В  редакторе  это  выводит  на экран Resource
Selection диалоговое окно.
     Примечание: Если   файл   не  содержит  Windows  ресурса,
Resource Manager указывает, что нельзя открыть файл. Например,
если Вы выбираете не Windows .EXE файл, то Resource Manager не
может открыть этот файл.
     4. Выберите типы ресурсов любым из следующих способов:
     - и для Resource Manager,  и для любого  редактора  можно
нажать Enter, чтобы получить доступ к выбранному ресурсу. Если
Вы работаете из Resource Manager,  он  начинает  работу  соот-
ветствующего редактора  ресурсов.  В  зависимости от редактора
можно получить небольшое диалоговое окно подтверждения; напри-
мер, для размера изображения в редакторе пиктограмм.
     - в Resource Manager активизируется  поле  редактирования
окна просмотра посредством нажатия на него с помощью мышки или
посредством нажатия на клавишу Tab до тех пор, пока поле акти-
визировано. Затем наберите первую букву типа ресурсов, которое
Вы хотите выбрать.  Например, Вы можете нажать клавишу Tab для
выбора поля редактирования,  а затем набрать D для выбора типа
ресурсов диалогового окна.
     - нажмите  на  стрелку справа от поля редактирования окна
просмотра. Это приводит к появлению окна списка, которое изоб-
ражает все имеющиеся типы ресурсов.  Чтобы выбрать тип ресурса
из списка, нажмите на него с помощью мышки, или нажмите клави-
шу, соответствующую первой букве этого типа.  Например, Вы мо-
жете нажать D,  чтобы выбрать типы ресурсов диалогового  окна.
Как только Вы выбрали тип ресурса, отдельные ресурсы этого ти-
па перечисляются в окне списка окна просмотра.
     Замечание: Для  копирования,  переименования или удаления
можно выбрать  несколько  ресурсов.  Чтобы  выбрать   диапазон
ресурсов, выберите первый ресурс диапазона, затем нажмите кла-
вишу Shift и выберите последний ресурс диапазона. Это выбирает
все ресурсы между ними.  Чтобы выбрать отдельные ресурсы, наж-
мите клавишу Ctrl и нажмите с помощью мышки каждый ресурс, ко-
торый Вы  хотите  выбрать.  Чтобы  изменить  выбор  отдельного
ресурса в группе,  нажмите клавишу Ctrl и  нажмите  с  помощью
мышки на этот ресурс.
     5. Редактируйте,   копируйте   или   удаляйте   выбранные
ресурсы, как описано в следующих разделах.

                   Редактирование ресурса.

     Чтобы отредактировать  существующий  ресурс,  начиная  из
Resource Manager:
     1. Откройте файл, который содержит данный ресурс.
     2. Выберите  тип  ресурса  из  поля  редактирования  окна
просмотра ресурса.  Например, Вы можете выбрать диалоговое ок-
но. Это перечисляет отдельные ресурсы этого типа в окне списка
окна просмотра.
     3. В окне просмотра дважды нажмите с помощью мышки на имя
ресурса или номер,  или выберите ресурс и  нажмите  с  помощью
мышки на кнопку Edit.  Это автоматически начинает работу соот-
ветствующего редактора и загружает ресурс в этот редактор.
     При редактировании из редактора выберите  File│Open,  как
описано ранее.

                      Удаление ресурса.

     Чтобы удалить ресурс из файла (только Resource Manager):
     1. Откройте файл, который содержит этот ресурс.
     2. Выберите  тип  ресурса  из  поля  редактирования  окна
просмотра ресурса.  Например,  можно выбрать диалоговое  окно.
Это перечисляет отдельные ресурсы этого типа в окне списка ок-
на просмотра.
     3. В окне списка выберите ресурс(ы), который(ые) Вы хоти-
те удалить.
     4. Нажмите с помощью мышки на кнопку Delete.  Это удаляет
все выбранные ресурсы из открытого файла.
     Предупреждение: Ресурсы сразу же удаляются из файла. Убе-
дитесь, что выбраны только те ресурсы,  которые Вы хотите уда-
лить.

                     Копирование ресурса.

     Чтобы скопировать ресурс из одного файла в другой (только
Resource Manager):
     1. Используйте одно из окон просмотра ресурсов, чтобы от-
крыть файл, ресурсы которого Вы хотите скопировать.
     2. Используйте другое окно просмотра, чтобы открыть файл,
в который Вы хотите скопировать ресурсы.  Это может быть новый
или существующий файл.
     3. Из поля редактирования исходного  файла  наберите  или
выберите тип ресурса,  который Вы хотите копировать. Когда тип
выбран, отдельные ресурсы этого типа перечисляются в окне спи-
ска окна просмотра.
     4. Выберите один или несколько ресурсов для копирования.
     5. Нажмите с помощью мышки на кнопку Copy.  Это открывает
Resource Attributes диалоговое окно так,  чтобы можно было пе-
реименовать ресурс. Можно сделать это, если вы хотите заменить
один ресурс программы на другой.  Когда Вы знаете имя, которое
ожидает программа, Вы можете использовать это имя для замещае-
мого ресурса. Можно так же использовать окно атрибутов для из-
менения атрибутов  ресурсов  (атрибуты определены в главе 10).
Если Вы выбрали несколько ресурсов на последнем шаге,  то диа-
лог открывается отдельно для каждого выбранного ресурса.
     Примечание: Стрелки кнопки Copy показывают направление, в
котором можно копировать. Направление изменяется в зависимости
от того,  какое  окно  просмотра  Вы  используете  для  выбора
ресурсов. Стрелки  всегда  указывают  от  выбранного ресурса в
другой файл.
     6. Если Вы не хотите переименовывать текущий ресурс, наж-
мите с помощью мышки на клавишу OK.  Чтобы переименовать теку-
щий ресурс, наберите новое имя в поле Name диалога, затем наж-
мите с помощью мышки на кнопку OK.

                    Переименование ресурсов

     Вы можете изменить имя любого ресурса  в  открытом  файле
без копирования  его  из одного файла в другой.  Чтобы сделать
это, выполните инструкции для копирования ресурса, за исключе-
нием открытия второго файла, и Вы должны нажать с помощью мыш-
ки на кнопку Rename вместо кнопки Copy.
     Можно так  же  переименовать ресурс из редактора,  выбрав
File│Save As.

                    Резервные копии файлов

     Каждый раз,  когда Вы сохраняете файл,  Resource  Toolkit
делает резервную копию файла,  использующую первоначальное имя
файла, но заменяющую первый символ расширения файла на  тильду
(~). Чтобы  восстановить  файл,  замените  ~  на  первую букву
расширения файла.
     Например, если Вы делаете изменения   в  файле  с именем
CHART.ICO, а  затем  сохраняете  эти  изменения,  то  Resource
Toolkit сохраняет резервную копию первоначального файла,  наз-
вав ее CHART.~CO.  Чтобы восстановить этот  файл,  используйте
DOS команды  переименования или копирования для переименования
файла.

                    Создание нового файла

     Используйте один из двух методов для создания нового фай-
ла в Resource Toolkit:
     - Начните работу одного из редакторов Resource Toolkit  и
выберите File│New для создания нового файла.  Используйте этот
метод для создания нового файла  и  начните  определять  новый
ресурс. Инструкции по началу работы редактора приведены ранее.
     - Создайте новый файл в Resource Manager, нажав на клави-
шу New,  расположенную выше любого из окон просмотра.  Исполь-
зуйте этот метод для создания нового файла так,  чтобы в  него
можно было  копировать ресурсы из существующего файла.  Как Вы
увидите в  следующих  разделах,  можно  скопировать  несколько
ресурсов за один раз, не начиная работу редактора для загрузки
каждого ресурса.
     Чтобы создать новый файл для копирования в него существу-
ющих ресурсов:
     - Определите,  какое  из  Resource Manager окон просмотра
ресурсов Вы будете использовать и нажмите с помощью  мышки  на
его New кнопку. Это открывает диалоговое окно. Файлы, хранимые
в текущем справочнике перечислены в левом  окне  списка  этого
диалогового окна,  при  этом над окном списка идентифицируется
текущий справочник.  Правое окно списка диалогового окна пока-
зывает имеющиеся справочники.
     - Чтобы создать файл в другом справочнике, измените теку-
щий справочник.
     - Или создайте новый файл, или замените один из существу-
ющих файлов, выведенных на экран в левом окне списка:
       Чтобы создать новый файл:
       - Нажмите  с  помощью мышки на File Extension зависимую
кнопку для типа файла,  который Вы хотите  создать.  Зависимые
кнопки находятся  справа от окон выбора.  Типы файла,  которые
можно создать,  перечислены в верхнем правом углу  диалогового
окна.
       - Расположите курсор в поле записи и наберите имя  фай-
ла. Не включайте расширение файла;  расширения берется из File
Extention зависимой кнопки.
     Чтобы заменить один из файлов, перечисленных в левом окне
списка, выберите этот файл.  Это  автоматически  копирует  имя
файла в  поле  записи,  а  также выбирает соответствующую File
Extention зависимую кнопку.
     Нажмите с помощью мышки на New кнопку диалогового окна.
     Если Вы создаете новое имя файла,  это  создает  файл  на
диске, а также открывает его.
     Если Вы выбрали для замены существующий файл, то это отк-
рывает диалоговое окно для подтверждения замены:
     - Yes, замещает существующий файл новым пустым файлом.
     - No,  возвращает Вас в диалоговое окно так, чтобы можно
было задать имя другого файла.
     Предупреждение! Если  Вы нажали Yes,  то новый файл сразу
же создается на диске, замещая существующий файл. Не выбирайте
Yes, пока Вы не убедитесь в том, что нужно замещать данный су-
ществующий файл.
     Когда файл  создан,  его имя выводится на экран над окном
просмотра ресурсов.  Так как файл является новым.  то поле ре-
дактирования окна просмотра,  будет пустым.  Чтобы скопировать
ресурсы файла.  используйте  Resource  Manager   другое   окно
просмотра ресурсов для открытия существующего файла. Когда оба
файла открыты, можно скопировать ресурсы из существующего фай-
ла в новый.

                        Закрытие файла

     Когда Вы используете Resource Manager для открытия нового
и существующего  файла,  Open  и  New  кнопки  окон  просмотра
ресурсов заменяется на кнопку Close. Чтобы закрыть файл, когда
Вы работаете с ним, нажмите с помощью мышки на кнопку Close.
     Когда Вы нажмете с помощью мышки на кнопку Close, все из-
менения, которые Вы сделали в  файле  немедленно  сохраняются.
Close не открывает диалоговое окно для подтверждения необходи-
мости сохранения изменений.
     Чтобы  закрыть  файл  из  редактора,  выберите  Close  из
Conrol-box меню в верхнем левом углу редактора.

