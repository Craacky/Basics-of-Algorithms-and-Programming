                           ГЛАВА 4

                    ACCELERATOR РЕДАКТОР
     
     Редактор акселераторов (Accelerator) позволяет  создавать
и редактировать ресурсы акселераторов. Акселераторы - это "го-
рячие" клавиши для вызова команд программы. Внутри Accelerator
редактора можно создавать акселераторы, нажав на клавишу, а не
вводя их код.

                    Создание акселераторов

     Accelerator редактор сохраняет клавиши и коды акселерато-
ров в таблице акселераторов.  Таблица акселераторов обычно со-
держит семь столбцов (восемь,  если Вы редактируете файл заго-
ловков), которые  изображают  информацию об акселераторе.  Эти
столбцы определяются в конце этой главы.  Если файл заголовков
открыт, то  дополнительный  столбец  показывает символьное имя
акселератора; это описано ниже.
     Примечание. Инструкции  о  создании  или  открытии файлов
приведены выше.

                    Управление редактором

     Таблицей акселераторов можно управлять с помощью  клавиш,
описанных в  главе 10.  Чтобы добавить к таблице новую строку,
нажмите Ctrl-Enter. Это работает независимо от того, какое по-
ле активно,  когда  Вы  нажимаете Ctrl-Enter.  Определенные по
умолчанию значения автоматически вводятся  в  каждый  столбец,
который имеет такие значения.

                    Редактирование текста

     Вы можете редактировать поле Value (и поле Symbol,  когда
открыт файл заголовков).  Оставшиеся поля являются выбираемыми
полями. Вы можете редактировать эти поля способом ,  описанным
в главе 10.

                    Таблица акселераторов

     Таблица акселераторов - это место , где вы фактически оп-
ределяете клавиши акселераторов.  Обычно, можно определить лю-
бую виртуальную клавишу или любую символьную клавишу в качест-
ве акселератора  Вашей программы.  Однако,  Вы должны избегать
конфликтов с Windows использованием  акселераторов.  Например,
Вы не должны определять F10 как акселератор в Вашей программе,
потому что это противоречит Windows использованию F10 для  ак-
тивизации зоны  заголовков меню. Кроме того,  для пользователя
лучше, чтобы Вы следовали стандартам, принимаемым большинством
Windows программ. Например, если Ваша программа имеет Edit ме-
ню, то можно определить клавишу Del  в  качестве  акселератора
для операции Cut,  Shift-Del в качестве акселератора для Paste
и т.д.
     В таблице  акселераторов  имеется восемь столбцов:  Type,
Key, Code, Shift, Ctrl, Value, Invert и Symbol, если есть отк-
рытый файл заголовков. Используя эти столбцы, можно установить
информацию о каждом акселераторе.  Ниже  подробно  объясняется
каждый столбец.

                             Type

     Type (тип) столбец указывает,  как определен акселератор:
в Virtkey или ASCII коде.
     Virtkey означает  виртуальную клавишу и именует акселера-
торы в соответствии со множеством определений виртуальных кла-
виш, определенных для Windows.  ASCII показывает акселератор в
терминах его  ASCII  значения.  Например,  комбинация   клавиш
Ctrl-S - это Virtkey S и ASCII^S.
     Можно изменить тип,  нажав Spacebar или нажав V или  А  в
поле Type.
     Когда Вы определили акселератор,  Вы  можете  просмотреть
его  в другой форме посредством циклического перехода к проти-
воположному выбору; однако, не все акселераторы можно преобра-
зовать из одного типа в другой. Например, для F5 и PgUp клавиш
нет ASCII эквивалента,  а для восклицательного знака  (!)  нет
Virtkey эквивалента.

                             Key

     Этот столбец  представляет  собой  клавишу  акселератора.
Чтобы определить акселератор,  нажмите  на  желаемую  клавишу.
Например, чтобы определить Shift-Ins в качестве акселератора -
общий акселератор для Paste - не отпуская клавишу Shift,  наж-
мите клавишу Ins.
     Когда Вы определили  клавишу  акселератора,  все  поля  в
строке, за исключением поля Value,  заполняются автоматически.
В зависимости от определяемого акселератора в этом поле  могут
появляться различные  строки.  Например,  если  Вы определяете
Virtkey Ctrl-A,  то в этом поле появляется A.  Однако, если Вы
определяете ASCII Ctrl-A, то в этом поле появляется ^A.
     Если Вы пытаетесь ввести  акселератор,  который  является
неправильным для  выбранного в поле Type формата,  то редактор
издает сигнал,  указывающий, что он не может использовать этот
ключ.

                             Code

     Этот столбец  содержит  клавиатурный скан код акселерато-
ров.Он автоматически заполняется,  когда заполняется поле Key.
Код, который  зависит  от  того,  что  выбрано в столбце Type:
Virtkey или ASCII - это номер идентификатора клавиши на клави-
атуре. Он не может быть идентификатором, используемым в исход-
ном коде для идентификации  акселератора;  этот  идентификатор
выводится на экран в столбце Value.

                            Shift

     Этот столбец  указывает  нужно  ли нажимать клавишу Shift
для активизации акселератора, изображенного в поле Key.
     Если в  поле  Type выбран Virtkey,  то этот столбец имеет
значения Yes и No.  Это  значение  автоматически  обновляется,
когда акселератор определяется в поле Key,  поэтому обычно нет
необходимости изменять это поле  самому.  Чтобы  изменить  его
используйте Spacebar, или нажмите Y для Yes или N для NO.
     Если в поле Type  выбран  ASCII,  то  это  поле  остается
пустым. Клавиша Shift не применяется для ASCII кодов акселера-
торов.

                             Ctrl

     Этот столбец указывает,  нужно ли нажимать клавишу  Ctrl,
чтобы активизировать акселератор, изображенный в поле Key.
     Если в поле Type выбран Virtkey,  то этот  столбец  имеет
значение Yes или No.  Это значение автоматически  обновляется,
когда акселератор определяется в поле Key,  поэтому обычно нет
необходимости изменять это поле  самому.  Чтобы  изменить  его
используйте Spacebar, или нажмите Y для Yes или N для NO.
     Если в  поле  Type  выбран  ASCII,  то  это поле остается
пустым.  Клавиша Ctrl не применяется для ASCII кодов акселера-
торов.

                            Value

     Этот столбец  содержит номер идентификатора для акселера-
тора, определенного в поле Key.  Чтобы загрузить акселератор в
Вашу программу, ссылайтесь на этот номер в исходном коде прог-
раммы. Альтернативно, определите для акселератора символ.
     Введите значение,  как  оно  определено  в исходном коде.
Значение должно быть целым числом.
     Значения идентификаторов  акселераторов могут быть одина-
ковыми с идентификаторами,  используемыми в  других  ресурсах,
например, для управления в диалоговом окне. Это происходит по-
тому, что  Windows  интерпретирует   значение   идентификатора
в контексте ресурса, который используется в программе в данный
момент.

                            Invert

     Этот столбец указывает должен  ли  высвечиваться  элемент
главного меню,  связанный с акселератором, когда нажат акселе-
ратор. Значение должно быть или Yes или No.

                            Symbol

     Этот столбец содержит символ,  номер идентификатора кото-
рого в  файле  заголовков соответствует значению для  текущего
акселератора. Чтобы загрузить акселератор в Вашу программу, Вы
можете ссылаться на этот символ в исходном коде программы. Бо-
лее подробная информация о файлах заголовков приведена в главе
9; в следующем разделе кратко описано,  как открыть файл заго-
ловков.

                       Файлы заголовков

     Чтобы открыть файл заголовков для просмотра или  редакти-
рования символов  во время определения ресурсов акселераторов,
выберите File│Open Header из меню Accelerator  редактора.  Это
добавляет столбец  Symbol  к  таблице акселераторов.  Открытие
файла заголовков приводит к  открытию  специального  редактора
файла заголовков.  Можно  редактировать  символьные значения с
помощью редактора файла заголовков или  редактировать  их  не-
посредственно из таблицы акселераторов.
     Примечание. Более подробная информация о файлах  заголов-
ков и  инструкции по редактированию символьных значений приве-
дены в главе 9.



